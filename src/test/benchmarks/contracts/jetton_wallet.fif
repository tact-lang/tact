"Asm.fif" include

PROGRAM{
  111 DECLMETHOD test_fun_1
  222 DECLMETHOD test_fun_2
  333 DECLMETHOD test_fun_3
  DECLPROC recv_internal
  777 DECLMETHOD __tact_selector_hack

  test_fun_1 PROC:<{
    1000 PUSHINT
  }>

  test_fun_2 PROC:<{
    2000 PUSHINT
  }>

  test_fun_3 PROCINLINE:<{
    3000 PUSHINT
  }>

  recv_internal PROC:<{
    456 PUSHINT
    test_fun_1 INLINECALLDICT
  }>

  __tact_selector_hack PROC:<{
    
    @atend @ 1 {
        execute current@ context@ current!
        {
            }END> b>
            
            <{
                SETCP0 DUP
                IFNOTJMP:<{
                    DROP over <s ref@ 0 swap @procdictkeylen idict@ { "internal error" abort } ifnot @addop
                }>
                swap <s ref@
                0 swap @procdictkeylen idict- drop
                777 swap @procdictkeylen idict- drop

                @procdictkeylen DICTPUSHCONST DICTIGETJMPZ 11 THROWARG
            }> b>
        } : }END>c
        current@ context! current!
    } does @atend !

  }>
}END>c <s

222 swap
.s runvmcode .s