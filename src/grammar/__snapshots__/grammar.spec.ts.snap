// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`grammar should fail case-0 1`] = `
"<unknown>:1:1: Abstract function doesn't have abstract modifier
Line 1, col 1:
> 1 | fun testFunc(): Int;
      ^~~~~~~~~~~~~~~~~~~~
"
`;

exports[`grammar should fail case-1 1`] = `
"<unknown>:1:5: Variable name cannot start with "__gen"
Line 1, col 5:
> 1 | fun __gen_hello(): Int {
          ^~~~~~~~~~~
  2 |     
"
`;

exports[`grammar should fail case-2 1`] = `
"<unknown>:2:9: Variable name cannot start with "__gen"
Line 2, col 9:
  1 | fun hello(): Int {
> 2 |     let __gen_a: Int = 0;
              ^~~~~~~
  3 | }
"
`;

exports[`grammar should fail case-3 1`] = `
"<unknown>:2:9: Variable name cannot start with "__tact"
Line 2, col 9:
  1 | fun hello(): Int {
> 2 |     let __tact_a: Int = 0;
              ^~~~~~~~
  3 | }
"
`;

exports[`grammar should fail case-4 1`] = `
"<unknown>:2:9: Syntax error: expected not a reservedWord 
Line 2, col 9:
  1 | fun hello(): Int {
> 2 |     let if: Int = 0;
              ^
  3 | }
"
`;

exports[`grammar should fail case-5 1`] = `
"<unknown>:1:8: Syntax error: expected "A".."Z" 
Line 1, col 8:
> 1 | struct __genA {
             ^
  2 |     a: Int;
"
`;

exports[`grammar should fail case-6 1`] = `
"<unknown>:1:10: Variable name cannot start with "__gen"
Line 1, col 10:
> 1 | fun main(__gen: Int): Int {
               ^~~~~
  2 |     return 0;
"
`;

exports[`grammar should fail case-7 1`] = `
"<unknown>:1:10: Variable name cannot start with "__gen"
Line 1, col 10:
> 1 | contract __gen_a {
               ^~~~~~~
  2 | 
"
`;

exports[`grammar should fail case-8 1`] = `
"<unknown>:2:10: Variable name cannot start with "__tact"
Line 2, col 10:
  1 | contract A {
> 2 |     init(__tact: Int) {
               ^~~~~~
  3 |         
"
`;

exports[`grammar should fail case-9 1`] = `
"<unknown>:2:11: Variable name cannot start with "__tact"
Line 2, col 11:
  1 | contract A {
> 2 |     fun b(__tact: Int) {
                ^~~~~~
  3 |         
"
`;

exports[`grammar should fail case-10 1`] = `
"<unknown>:1:8: Syntax error: expected "A".."Z" 
Line 1, col 8:
> 1 | struct lowercaseIdforType {
             ^
  2 |     a: Int;
"
`;

exports[`grammar should fail case-11 1`] = `
"<unknown>:1:14: Syntax error: expected "A".."Z" 
Line 1, col 14:
> 1 | message(123) foo {
                   ^
  2 |     signature: Slice;
"
`;

exports[`grammar should fail case-12 1`] = `
"<unknown>:2:14: Syntax error: expected "1" or "0" 
Line 2, col 14:
  1 | fun test_fun(): Int {
> 2 |     return 0b_00101010;
                   ^
  3 | }
"
`;

exports[`grammar should fail case-13 1`] = `
"<unknown>:2:15: Syntax error: expected ";" 
Line 2, col 15:
  1 | fun test_fun(): Int {
> 2 |     return 0b123;
                    ^
  3 | }
"
`;

exports[`grammar should fail case-14 1`] = `
"<unknown>:2:16: Syntax error: expected a digit 
Line 2, col 16:
  1 | fun test_fun(): Int {
> 2 |     return 123_;
                     ^
  3 | }
"
`;

exports[`grammar should fail case-15 1`] = `
"<unknown>:2:18: Syntax error: expected a hexadecimal digit 
Line 2, col 18:
  1 | fun test_fun(): Int {
> 2 |     return 0x123_;
                       ^
  3 | }
"
`;

exports[`grammar should fail case-16 1`] = `
"<unknown>:2:13: Syntax error: expected ";" 
Line 2, col 13:
  1 | fun test_fun(): Int {
> 2 |     return 0_123;
                  ^
  3 | }
"
`;

exports[`grammar should fail case-17 1`] = `
"<unknown>:2:20: Syntax error: expected a digit 
Line 2, col 20:
  1 | fun test_fun(): Int {
> 2 |     return 123_123__123;
                         ^
  3 | }
"
`;

exports[`grammar should fail case-18 1`] = `
"<unknown>:2:15: Syntax error: expected ";" 
Line 2, col 15:
  1 | fun test_fun(): Int {
> 2 |     return 012_3;
                    ^
  3 | }
"
`;

exports[`grammar should fail case-19 1`] = `
"<unknown>:1:14: Empty parameter list should not have a dangling comma.
Line 1, col 14:
> 1 | fun function(,) {}
                   ^
  2 | 
"
`;

exports[`grammar should fail case-20 1`] = `
"<unknown>:2:24: Empty parameter list should not have a dangling comma.
Line 2, col 24:
  1 | fun another() {
> 2 |     return 42.toString(,);
                             ^
  3 | }
"
`;

exports[`grammar should fail case-21 1`] = `
"<unknown>:1:14: Empty parameter list should not have a dangling comma.
Line 1, col 14:
> 1 | fun function(,) : Int {
                   ^
  2 |     return 42;
"
`;

exports[`grammar should fail case-22 1`] = `
"<unknown>:6:14: Empty parameter list should not have a dangling comma.
Line 6, col 14:
  5 | fun b(): Int {
> 6 |     return a(,);
                   ^
  7 | }
"
`;

exports[`grammar should fail case-23 1`] = `
"<unknown>:2:23: Empty parameter list should not have a dangling comma.
Line 2, col 23:
  1 | @name(native_name_1)
> 2 | native testNativeFunc(,);
                            ^
"
`;

exports[`grammar should fail case-24 1`] = `
"<unknown>:1:31: Empty parameter list should not have a dangling comma.
Line 1, col 31:
> 1 | abstract fun testFuncAbstract(,);
                                    ^
"
`;

exports[`grammar should fail case-25 1`] = `
"<unknown>:1:39: Empty parameter list should not have a dangling comma.
Line 1, col 39:
> 1 | abstract fun testFuncAbstractWithType(,): Int;
                                            ^
"
`;

exports[`grammar should fail case-26 1`] = `
"<unknown>:2:31: Empty parameter list should not have a dangling comma.
Line 2, col 31:
  1 | @name(native_name_2)
> 2 | native testNativeFuncWithType(,): Int;
                                    ^
"
`;

exports[`grammar should fail case-27 1`] = `
"<unknown>:1:19: Syntax error: expected "_", "A".."Z", or "a".."z" 
Line 1, col 19:
> 1 | contract Name with, {}
                        ^
  2 | 
"
`;

exports[`grammar should fail case-28 1`] = `
"<unknown>:1:16: Syntax error: expected "_", "A".."Z", or "a".."z" 
Line 1, col 16:
> 1 | trait Name with, {}
                     ^
  2 | 
"
`;

exports[`grammar should fail case-29 1`] = `
"<unknown>:2:10: Empty parameter list should not have a dangling comma.
Line 2, col 10:
  1 | contract Name {
> 2 |     init(,) {}
               ^
  3 | }
"
`;

exports[`grammar should fail case-30 1`] = `
"<unknown>:1:20: Syntax error: expected "_", "A".."Z", or "a".."z" 
Line 1, col 20:
> 1 | contract Name with {}
                         ^
  2 | 
"
`;

exports[`grammar should fail case-31 1`] = `
"<unknown>:1:17: Syntax error: expected "_", "A".."Z", or "a".."z" 
Line 1, col 17:
> 1 | trait Name with {}
                      ^
  2 | 
"
`;

exports[`grammar should parse case-0 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 4,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    return 0;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 2,
            "kind": "number",
            "ref": 0,
            "value": 0n,
          },
          "id": 3,
          "kind": "statement_return",
          "ref": return 0;,
        },
      ],
    },
  ],
  "id": 5,
  "kind": "program",
}
`;

exports[`grammar should parse case-1 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 10,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    return (0 + 1) * 10 / 20;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 8,
            "kind": "op_binary",
            "left": {
              "id": 6,
              "kind": "op_binary",
              "left": {
                "id": 4,
                "kind": "op_binary",
                "left": {
                  "id": 2,
                  "kind": "number",
                  "ref": 0,
                  "value": 0n,
                },
                "op": "+",
                "ref": 0 + 1,
                "right": {
                  "id": 3,
                  "kind": "number",
                  "ref": 1,
                  "value": 1n,
                },
              },
              "op": "*",
              "ref": (0 + 1) * 10,
              "right": {
                "id": 5,
                "kind": "number",
                "ref": 10,
                "value": 10n,
              },
            },
            "op": "/",
            "ref": (0 + 1) * 10 / 20,
            "right": {
              "id": 7,
              "kind": "number",
              "ref": 20,
              "value": 20n,
            },
          },
          "id": 9,
          "kind": "statement_return",
          "ref": return (0 + 1) * 10 / 20;,
        },
      ],
    },
  ],
  "id": 11,
  "kind": "program",
}
`;

exports[`grammar should parse case-2 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 12,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    return (0 + 1) * 10 / 20 != 10;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 10,
            "kind": "op_binary",
            "left": {
              "id": 8,
              "kind": "op_binary",
              "left": {
                "id": 6,
                "kind": "op_binary",
                "left": {
                  "id": 4,
                  "kind": "op_binary",
                  "left": {
                    "id": 2,
                    "kind": "number",
                    "ref": 0,
                    "value": 0n,
                  },
                  "op": "+",
                  "ref": 0 + 1,
                  "right": {
                    "id": 3,
                    "kind": "number",
                    "ref": 1,
                    "value": 1n,
                  },
                },
                "op": "*",
                "ref": (0 + 1) * 10,
                "right": {
                  "id": 5,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
              },
              "op": "/",
              "ref": (0 + 1) * 10 / 20,
              "right": {
                "id": 7,
                "kind": "number",
                "ref": 20,
                "value": 20n,
              },
            },
            "op": "!=",
            "ref": (0 + 1) * 10 / 20 != 10,
            "right": {
              "id": 9,
              "kind": "number",
              "ref": 10,
              "value": 10n,
            },
          },
          "id": 11,
          "kind": "statement_return",
          "ref": return (0 + 1) * 10 / 20 != 10;,
        },
      ],
    },
  ],
  "id": 13,
  "kind": "program",
}
`;

exports[`grammar should parse case-3 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 14,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    return (0 + 1) * 10 / 20 != 10 * someId;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 12,
            "kind": "op_binary",
            "left": {
              "id": 8,
              "kind": "op_binary",
              "left": {
                "id": 6,
                "kind": "op_binary",
                "left": {
                  "id": 4,
                  "kind": "op_binary",
                  "left": {
                    "id": 2,
                    "kind": "number",
                    "ref": 0,
                    "value": 0n,
                  },
                  "op": "+",
                  "ref": 0 + 1,
                  "right": {
                    "id": 3,
                    "kind": "number",
                    "ref": 1,
                    "value": 1n,
                  },
                },
                "op": "*",
                "ref": (0 + 1) * 10,
                "right": {
                  "id": 5,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
              },
              "op": "/",
              "ref": (0 + 1) * 10 / 20,
              "right": {
                "id": 7,
                "kind": "number",
                "ref": 20,
                "value": 20n,
              },
            },
            "op": "!=",
            "ref": (0 + 1) * 10 / 20 != 10 * someId,
            "right": {
              "id": 11,
              "kind": "op_binary",
              "left": {
                "id": 9,
                "kind": "number",
                "ref": 10,
                "value": 10n,
              },
              "op": "*",
              "ref": 10 * someId,
              "right": {
                "id": 10,
                "kind": "id",
                "ref": someId,
                "value": "someId",
              },
            },
          },
          "id": 13,
          "kind": "statement_return",
          "ref": return (0 + 1) * 10 / 20 != 10 * someId;,
        },
      ],
    },
  ],
  "id": 15,
  "kind": "program",
}
`;

exports[`grammar should parse case-4 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 22,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    return (0 + 1) * 10 / 20 != 10 * someId || some2 > 10 && some3 < 10;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 20,
            "kind": "op_binary",
            "left": {
              "id": 12,
              "kind": "op_binary",
              "left": {
                "id": 8,
                "kind": "op_binary",
                "left": {
                  "id": 6,
                  "kind": "op_binary",
                  "left": {
                    "id": 4,
                    "kind": "op_binary",
                    "left": {
                      "id": 2,
                      "kind": "number",
                      "ref": 0,
                      "value": 0n,
                    },
                    "op": "+",
                    "ref": 0 + 1,
                    "right": {
                      "id": 3,
                      "kind": "number",
                      "ref": 1,
                      "value": 1n,
                    },
                  },
                  "op": "*",
                  "ref": (0 + 1) * 10,
                  "right": {
                    "id": 5,
                    "kind": "number",
                    "ref": 10,
                    "value": 10n,
                  },
                },
                "op": "/",
                "ref": (0 + 1) * 10 / 20,
                "right": {
                  "id": 7,
                  "kind": "number",
                  "ref": 20,
                  "value": 20n,
                },
              },
              "op": "!=",
              "ref": (0 + 1) * 10 / 20 != 10 * someId,
              "right": {
                "id": 11,
                "kind": "op_binary",
                "left": {
                  "id": 9,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
                "op": "*",
                "ref": 10 * someId,
                "right": {
                  "id": 10,
                  "kind": "id",
                  "ref": someId,
                  "value": "someId",
                },
              },
            },
            "op": "||",
            "ref": (0 + 1) * 10 / 20 != 10 * someId || some2 > 10 && some3 < 10,
            "right": {
              "id": 19,
              "kind": "op_binary",
              "left": {
                "id": 15,
                "kind": "op_binary",
                "left": {
                  "id": 13,
                  "kind": "id",
                  "ref": some2,
                  "value": "some2",
                },
                "op": ">",
                "ref": some2 > 10,
                "right": {
                  "id": 14,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
              },
              "op": "&&",
              "ref": some2 > 10 && some3 < 10,
              "right": {
                "id": 18,
                "kind": "op_binary",
                "left": {
                  "id": 16,
                  "kind": "id",
                  "ref": some3,
                  "value": "some3",
                },
                "op": "<",
                "ref": some3 < 10,
                "right": {
                  "id": 17,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
              },
            },
          },
          "id": 21,
          "kind": "statement_return",
          "ref": return (0 + 1) * 10 / 20 != 10 * someId || some2 > 10 && some3 < 10;,
        },
      ],
    },
  ],
  "id": 23,
  "kind": "program",
}
`;

exports[`grammar should parse case-5 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 24,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    return (0 + 1) * 10 / 20 != 10 * someId || some2 > 10 && some3 < 123.add(10);
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 22,
            "kind": "op_binary",
            "left": {
              "id": 12,
              "kind": "op_binary",
              "left": {
                "id": 8,
                "kind": "op_binary",
                "left": {
                  "id": 6,
                  "kind": "op_binary",
                  "left": {
                    "id": 4,
                    "kind": "op_binary",
                    "left": {
                      "id": 2,
                      "kind": "number",
                      "ref": 0,
                      "value": 0n,
                    },
                    "op": "+",
                    "ref": 0 + 1,
                    "right": {
                      "id": 3,
                      "kind": "number",
                      "ref": 1,
                      "value": 1n,
                    },
                  },
                  "op": "*",
                  "ref": (0 + 1) * 10,
                  "right": {
                    "id": 5,
                    "kind": "number",
                    "ref": 10,
                    "value": 10n,
                  },
                },
                "op": "/",
                "ref": (0 + 1) * 10 / 20,
                "right": {
                  "id": 7,
                  "kind": "number",
                  "ref": 20,
                  "value": 20n,
                },
              },
              "op": "!=",
              "ref": (0 + 1) * 10 / 20 != 10 * someId,
              "right": {
                "id": 11,
                "kind": "op_binary",
                "left": {
                  "id": 9,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
                "op": "*",
                "ref": 10 * someId,
                "right": {
                  "id": 10,
                  "kind": "id",
                  "ref": someId,
                  "value": "someId",
                },
              },
            },
            "op": "||",
            "ref": (0 + 1) * 10 / 20 != 10 * someId || some2 > 10 && some3 < 123.add(10),
            "right": {
              "id": 21,
              "kind": "op_binary",
              "left": {
                "id": 15,
                "kind": "op_binary",
                "left": {
                  "id": 13,
                  "kind": "id",
                  "ref": some2,
                  "value": "some2",
                },
                "op": ">",
                "ref": some2 > 10,
                "right": {
                  "id": 14,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
              },
              "op": "&&",
              "ref": some2 > 10 && some3 < 123.add(10),
              "right": {
                "id": 20,
                "kind": "op_binary",
                "left": {
                  "id": 16,
                  "kind": "id",
                  "ref": some3,
                  "value": "some3",
                },
                "op": "<",
                "ref": some3 < 123.add(10),
                "right": {
                  "args": [
                    {
                      "id": 18,
                      "kind": "number",
                      "ref": 10,
                      "value": 10n,
                    },
                  ],
                  "id": 19,
                  "kind": "op_call",
                  "name": "add",
                  "ref": 123.add(10),
                  "src": {
                    "id": 17,
                    "kind": "number",
                    "ref": 123,
                    "value": 123n,
                  },
                },
              },
            },
          },
          "id": 23,
          "kind": "statement_return",
          "ref": return (0 + 1) * 10 / 20 != 10 * someId || some2 > 10 && some3 < 123.add(10);,
        },
      ],
    },
  ],
  "id": 25,
  "kind": "program",
}
`;

exports[`grammar should parse case-6 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 25,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    return (0 + 1) * 10 / 20 != 10 * someId || some2 > 10 && some3 < abs(123.add(10));
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 23,
            "kind": "op_binary",
            "left": {
              "id": 12,
              "kind": "op_binary",
              "left": {
                "id": 8,
                "kind": "op_binary",
                "left": {
                  "id": 6,
                  "kind": "op_binary",
                  "left": {
                    "id": 4,
                    "kind": "op_binary",
                    "left": {
                      "id": 2,
                      "kind": "number",
                      "ref": 0,
                      "value": 0n,
                    },
                    "op": "+",
                    "ref": 0 + 1,
                    "right": {
                      "id": 3,
                      "kind": "number",
                      "ref": 1,
                      "value": 1n,
                    },
                  },
                  "op": "*",
                  "ref": (0 + 1) * 10,
                  "right": {
                    "id": 5,
                    "kind": "number",
                    "ref": 10,
                    "value": 10n,
                  },
                },
                "op": "/",
                "ref": (0 + 1) * 10 / 20,
                "right": {
                  "id": 7,
                  "kind": "number",
                  "ref": 20,
                  "value": 20n,
                },
              },
              "op": "!=",
              "ref": (0 + 1) * 10 / 20 != 10 * someId,
              "right": {
                "id": 11,
                "kind": "op_binary",
                "left": {
                  "id": 9,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
                "op": "*",
                "ref": 10 * someId,
                "right": {
                  "id": 10,
                  "kind": "id",
                  "ref": someId,
                  "value": "someId",
                },
              },
            },
            "op": "||",
            "ref": (0 + 1) * 10 / 20 != 10 * someId || some2 > 10 && some3 < abs(123.add(10)),
            "right": {
              "id": 22,
              "kind": "op_binary",
              "left": {
                "id": 15,
                "kind": "op_binary",
                "left": {
                  "id": 13,
                  "kind": "id",
                  "ref": some2,
                  "value": "some2",
                },
                "op": ">",
                "ref": some2 > 10,
                "right": {
                  "id": 14,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
              },
              "op": "&&",
              "ref": some2 > 10 && some3 < abs(123.add(10)),
              "right": {
                "id": 21,
                "kind": "op_binary",
                "left": {
                  "id": 16,
                  "kind": "id",
                  "ref": some3,
                  "value": "some3",
                },
                "op": "<",
                "ref": some3 < abs(123.add(10)),
                "right": {
                  "args": [
                    {
                      "args": [
                        {
                          "id": 18,
                          "kind": "number",
                          "ref": 10,
                          "value": 10n,
                        },
                      ],
                      "id": 19,
                      "kind": "op_call",
                      "name": "add",
                      "ref": 123.add(10),
                      "src": {
                        "id": 17,
                        "kind": "number",
                        "ref": 123,
                        "value": 123n,
                      },
                    },
                  ],
                  "id": 20,
                  "kind": "op_static_call",
                  "name": "abs",
                  "ref": abs(123.add(10)),
                },
              },
            },
          },
          "id": 24,
          "kind": "statement_return",
          "ref": return (0 + 1) * 10 / 20 != 10 * someId || some2 > 10 && some3 < abs(123.add(10));,
        },
      ],
    },
  ],
  "id": 26,
  "kind": "program",
}
`;

exports[`grammar should parse case-7 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 3,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc() {
    return 0;
},
      "return": null,
      "statements": [
        {
          "expression": {
            "id": 1,
            "kind": "number",
            "ref": 0,
            "value": 0n,
          },
          "id": 2,
          "kind": "statement_return",
          "ref": return 0;,
        },
      ],
    },
    {
      "args": [],
      "attributes": [],
      "id": 7,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    return 0;
},
      "return": {
        "id": 4,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 5,
            "kind": "number",
            "ref": 0,
            "value": 0n,
          },
          "id": 6,
          "kind": "statement_return",
          "ref": return 0;,
        },
      ],
    },
    {
      "args": [],
      "attributes": [],
      "id": 11,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Bool {
    return 0;
},
      "return": {
        "id": 8,
        "kind": "type_ref_simple",
        "name": "Bool",
        "optional": false,
        "ref": Bool,
      },
      "statements": [
        {
          "expression": {
            "id": 9,
            "kind": "number",
            "ref": 0,
            "value": 0n,
          },
          "id": 10,
          "kind": "statement_return",
          "ref": return 0;,
        },
      ],
    },
  ],
  "id": 12,
  "kind": "program",
}
`;

exports[`grammar should parse case-8 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 1,
      "kind": "def_native_function",
      "name": "testFunc",
      "nativeName": "native_name_1",
      "origin": "user",
      "ref": @name(native_name_1)
native testFunc();,
      "return": null,
    },
    {
      "args": [],
      "attributes": [],
      "id": 3,
      "kind": "def_native_function",
      "name": "testFunc",
      "nativeName": "native_name_2",
      "origin": "user",
      "ref": @name(native_name_2)
native testFunc(): Int;,
      "return": {
        "id": 2,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
    },
    {
      "args": [],
      "attributes": [],
      "id": 5,
      "kind": "def_native_function",
      "name": "testFunc",
      "nativeName": "native_name_3",
      "origin": "user",
      "ref": @name(native_name_3)
native testFunc(): Bool;,
      "return": {
        "id": 4,
        "kind": "type_ref_simple",
        "name": "Bool",
        "optional": false,
        "ref": Bool,
      },
    },
  ],
  "id": 6,
  "kind": "program",
}
`;

exports[`grammar should parse case-9 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 11,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    return 1 + 2 + 3!! > 123;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 9,
            "kind": "op_binary",
            "left": {
              "id": 7,
              "kind": "op_binary",
              "left": {
                "id": 4,
                "kind": "op_binary",
                "left": {
                  "id": 2,
                  "kind": "number",
                  "ref": 1,
                  "value": 1n,
                },
                "op": "+",
                "ref": 1 + 2,
                "right": {
                  "id": 3,
                  "kind": "number",
                  "ref": 2,
                  "value": 2n,
                },
              },
              "op": "+",
              "ref": 1 + 2 + 3!!,
              "right": {
                "id": 6,
                "kind": "op_unary",
                "op": "!!",
                "ref": 3!!,
                "right": {
                  "id": 5,
                  "kind": "number",
                  "ref": 3,
                  "value": 3n,
                },
              },
            },
            "op": ">",
            "ref": 1 + 2 + 3!! > 123,
            "right": {
              "id": 8,
              "kind": "number",
              "ref": 123,
              "value": 123n,
            },
          },
          "id": 10,
          "kind": "statement_return",
          "ref": return 1 + 2 + 3!! > 123;,
        },
      ],
    },
  ],
  "id": 12,
  "kind": "program",
}
`;

exports[`grammar should parse case-10 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 13,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    return 1 + 2 + (123 + 3)!! > 123;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 11,
            "kind": "op_binary",
            "left": {
              "id": 9,
              "kind": "op_binary",
              "left": {
                "id": 4,
                "kind": "op_binary",
                "left": {
                  "id": 2,
                  "kind": "number",
                  "ref": 1,
                  "value": 1n,
                },
                "op": "+",
                "ref": 1 + 2,
                "right": {
                  "id": 3,
                  "kind": "number",
                  "ref": 2,
                  "value": 2n,
                },
              },
              "op": "+",
              "ref": 1 + 2 + (123 + 3)!!,
              "right": {
                "id": 8,
                "kind": "op_unary",
                "op": "!!",
                "ref": (123 + 3)!!,
                "right": {
                  "id": 7,
                  "kind": "op_binary",
                  "left": {
                    "id": 5,
                    "kind": "number",
                    "ref": 123,
                    "value": 123n,
                  },
                  "op": "+",
                  "ref": 123 + 3,
                  "right": {
                    "id": 6,
                    "kind": "number",
                    "ref": 3,
                    "value": 3n,
                  },
                },
              },
            },
            "op": ">",
            "ref": 1 + 2 + (123 + 3)!! > 123,
            "right": {
              "id": 10,
              "kind": "number",
              "ref": 123,
              "value": 123n,
            },
          },
          "id": 12,
          "kind": "statement_return",
          "ref": return 1 + 2 + (123 + 3)!! > 123;,
        },
      ],
    },
  ],
  "id": 14,
  "kind": "program",
}
`;

exports[`grammar should parse case-11 1`] = `
{
  "entries": [
    {
      "args": [
        {
          "id": 3,
          "kind": "def_argument",
          "name": "src",
          "ref": src: Int?,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": true,
            "ref": Int?,
          },
        },
      ],
      "attributes": [],
      "id": 15,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(src: Int?): Int {
    return 1 + 2 + (123 + 3)!! > 123;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 13,
            "kind": "op_binary",
            "left": {
              "id": 11,
              "kind": "op_binary",
              "left": {
                "id": 6,
                "kind": "op_binary",
                "left": {
                  "id": 4,
                  "kind": "number",
                  "ref": 1,
                  "value": 1n,
                },
                "op": "+",
                "ref": 1 + 2,
                "right": {
                  "id": 5,
                  "kind": "number",
                  "ref": 2,
                  "value": 2n,
                },
              },
              "op": "+",
              "ref": 1 + 2 + (123 + 3)!!,
              "right": {
                "id": 10,
                "kind": "op_unary",
                "op": "!!",
                "ref": (123 + 3)!!,
                "right": {
                  "id": 9,
                  "kind": "op_binary",
                  "left": {
                    "id": 7,
                    "kind": "number",
                    "ref": 123,
                    "value": 123n,
                  },
                  "op": "+",
                  "ref": 123 + 3,
                  "right": {
                    "id": 8,
                    "kind": "number",
                    "ref": 3,
                    "value": 3n,
                  },
                },
              },
            },
            "op": ">",
            "ref": 1 + 2 + (123 + 3)!! > 123,
            "right": {
              "id": 12,
              "kind": "number",
              "ref": 123,
              "value": 123n,
            },
          },
          "id": 14,
          "kind": "statement_return",
          "ref": return 1 + 2 + (123 + 3)!! > 123;,
        },
      ],
    },
  ],
  "id": 16,
  "kind": "program",
}
`;

exports[`grammar should parse case-12 1`] = `
{
  "entries": [
    {
      "args": [
        {
          "id": 3,
          "kind": "def_argument",
          "name": "src",
          "ref": src: Int?,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": true,
            "ref": Int?,
          },
        },
      ],
      "attributes": [],
      "id": 12,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(src: Int?): Int {
    if (src != null) {
        return src;
    }
    return 0;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "elseif": null,
          "expression": {
            "id": 6,
            "kind": "op_binary",
            "left": {
              "id": 4,
              "kind": "id",
              "ref": src,
              "value": "src",
            },
            "op": "!=",
            "ref": src != null,
            "right": {
              "id": 5,
              "kind": "null",
              "ref": null,
            },
          },
          "falseStatements": null,
          "id": 9,
          "kind": "statement_condition",
          "ref": if (src != null) {
        return src;
    },
          "trueStatements": [
            {
              "expression": {
                "id": 7,
                "kind": "id",
                "ref": src,
                "value": "src",
              },
              "id": 8,
              "kind": "statement_return",
              "ref": return src;,
            },
          ],
        },
        {
          "expression": {
            "id": 10,
            "kind": "number",
            "ref": 0,
            "value": 0n,
          },
          "id": 11,
          "kind": "statement_return",
          "ref": return 0;,
        },
      ],
    },
  ],
  "id": 13,
  "kind": "program",
}
`;

exports[`grammar should parse case-13 1`] = `
{
  "entries": [
    {
      "args": [
        {
          "id": 3,
          "kind": "def_argument",
          "name": "src",
          "ref": src: Int?,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": true,
            "ref": Int?,
          },
        },
      ],
      "attributes": [],
      "id": 12,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(src: Int?): Int {
    if (src != null) {
        return src;
    } else {
        return 10;
    }
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "elseif": null,
          "expression": {
            "id": 6,
            "kind": "op_binary",
            "left": {
              "id": 4,
              "kind": "id",
              "ref": src,
              "value": "src",
            },
            "op": "!=",
            "ref": src != null,
            "right": {
              "id": 5,
              "kind": "null",
              "ref": null,
            },
          },
          "falseStatements": [
            {
              "expression": {
                "id": 9,
                "kind": "number",
                "ref": 10,
                "value": 10n,
              },
              "id": 10,
              "kind": "statement_return",
              "ref": return 10;,
            },
          ],
          "id": 11,
          "kind": "statement_condition",
          "ref": if (src != null) {
        return src;
    } else {
        return 10;
    },
          "trueStatements": [
            {
              "expression": {
                "id": 7,
                "kind": "id",
                "ref": src,
                "value": "src",
              },
              "id": 8,
              "kind": "statement_return",
              "ref": return src;,
            },
          ],
        },
      ],
    },
  ],
  "id": 13,
  "kind": "program",
}
`;

exports[`grammar should parse case-14 1`] = `
{
  "entries": [
    {
      "attributes": [],
      "declarations": [
        {
          "as": null,
          "id": 2,
          "init": null,
          "kind": "def_field",
          "name": "a",
          "ref": a: Int;,
          "type": {
            "id": 1,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "as": null,
          "id": 4,
          "init": null,
          "kind": "def_field",
          "name": "b",
          "ref": b: Int;,
          "type": {
            "id": 3,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "args": [
            {
              "id": 6,
              "kind": "def_argument",
              "name": "a",
              "ref": a: Int,
              "type": {
                "id": 5,
                "kind": "type_ref_simple",
                "name": "Int",
                "optional": false,
                "ref": Int,
              },
            },
            {
              "id": 8,
              "kind": "def_argument",
              "name": "b",
              "ref": b: Int,
              "type": {
                "id": 7,
                "kind": "type_ref_simple",
                "name": "Int",
                "optional": false,
                "ref": Int,
              },
            },
          ],
          "id": 17,
          "kind": "def_init_function",
          "ref": init(a: Int, b: Int) {
        self.a = a;
        self.b = b;
    },
          "statements": [
            {
              "expression": {
                "id": 11,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "id": 12,
              "kind": "statement_assign",
              "path": [
                {
                  "id": 9,
                  "kind": "lvalue_ref",
                  "name": "self",
                  "ref": self.,
                },
                {
                  "id": 10,
                  "kind": "lvalue_ref",
                  "name": "a",
                  "ref": a,
                },
              ],
              "ref": self.a = a;,
            },
            {
              "expression": {
                "id": 15,
                "kind": "id",
                "ref": b,
                "value": "b",
              },
              "id": 16,
              "kind": "statement_assign",
              "path": [
                {
                  "id": 13,
                  "kind": "lvalue_ref",
                  "name": "self",
                  "ref": self.,
                },
                {
                  "id": 14,
                  "kind": "lvalue_ref",
                  "name": "b",
                  "ref": b,
                },
              ],
              "ref": self.b = b;,
            },
          ],
        },
      ],
      "id": 18,
      "kind": "def_contract",
      "name": "Sample",
      "origin": "user",
      "ref": contract Sample {
    a: Int;
    b: Int;
    
    init(a: Int, b: Int) {
        self.a = a;
        self.b = b;
    }
},
      "traits": [],
    },
  ],
  "id": 19,
  "kind": "program",
}
`;

exports[`grammar should parse case-15 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 25,
      "kind": "def_function",
      "name": "main",
      "origin": "user",
      "ref": fun main() {
    let i: Int = 1;
    while(true) {
        i = i + 1;
    }
    repeat(10) {
        i = i * 10;
    }
    do {
        i = i - 1;
    } until(false);
},
      "return": null,
      "statements": [
        {
          "expression": {
            "id": 2,
            "kind": "number",
            "ref": 1,
            "value": 1n,
          },
          "id": 3,
          "kind": "statement_let",
          "name": "i",
          "ref": let i: Int = 1;,
          "type": {
            "id": 1,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "condition": {
            "id": 4,
            "kind": "boolean",
            "ref": true,
            "value": true,
          },
          "id": 10,
          "kind": "statement_while",
          "ref": while(true) {
        i = i + 1;
    },
          "statements": [
            {
              "expression": {
                "id": 8,
                "kind": "op_binary",
                "left": {
                  "id": 6,
                  "kind": "id",
                  "ref": i,
                  "value": "i",
                },
                "op": "+",
                "ref": i + 1,
                "right": {
                  "id": 7,
                  "kind": "number",
                  "ref": 1,
                  "value": 1n,
                },
              },
              "id": 9,
              "kind": "statement_assign",
              "path": [
                {
                  "id": 5,
                  "kind": "lvalue_ref",
                  "name": "i",
                  "ref": i,
                },
              ],
              "ref": i = i + 1;,
            },
          ],
        },
        {
          "id": 17,
          "iterations": {
            "id": 11,
            "kind": "number",
            "ref": 10,
            "value": 10n,
          },
          "kind": "statement_repeat",
          "ref": repeat(10) {
        i = i * 10;
    },
          "statements": [
            {
              "expression": {
                "id": 15,
                "kind": "op_binary",
                "left": {
                  "id": 13,
                  "kind": "id",
                  "ref": i,
                  "value": "i",
                },
                "op": "*",
                "ref": i * 10,
                "right": {
                  "id": 14,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
              },
              "id": 16,
              "kind": "statement_assign",
              "path": [
                {
                  "id": 12,
                  "kind": "lvalue_ref",
                  "name": "i",
                  "ref": i,
                },
              ],
              "ref": i = i * 10;,
            },
          ],
        },
        {
          "condition": {
            "id": 18,
            "kind": "boolean",
            "ref": false,
            "value": false,
          },
          "id": 24,
          "kind": "statement_until",
          "ref": do {
        i = i - 1;
    } until(false);,
          "statements": [
            {
              "expression": {
                "id": 22,
                "kind": "op_binary",
                "left": {
                  "id": 20,
                  "kind": "id",
                  "ref": i,
                  "value": "i",
                },
                "op": "-",
                "ref": i - 1,
                "right": {
                  "id": 21,
                  "kind": "number",
                  "ref": 1,
                  "value": 1n,
                },
              },
              "id": 23,
              "kind": "statement_assign",
              "path": [
                {
                  "id": 19,
                  "kind": "lvalue_ref",
                  "name": "i",
                  "ref": i,
                },
              ],
              "ref": i = i - 1;,
            },
          ],
        },
      ],
    },
  ],
  "id": 26,
  "kind": "program",
}
`;

exports[`grammar should parse case-16 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 17,
      "kind": "def_function",
      "name": "main",
      "origin": "user",
      "ref": fun main() {
    let i: Int = 1;
    while(i >= 10 || i <= 100) {
        i = i + 1;
    }
},
      "return": null,
      "statements": [
        {
          "expression": {
            "id": 2,
            "kind": "number",
            "ref": 1,
            "value": 1n,
          },
          "id": 3,
          "kind": "statement_let",
          "name": "i",
          "ref": let i: Int = 1;,
          "type": {
            "id": 1,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "condition": {
            "id": 10,
            "kind": "op_binary",
            "left": {
              "id": 6,
              "kind": "op_binary",
              "left": {
                "id": 4,
                "kind": "id",
                "ref": i,
                "value": "i",
              },
              "op": ">=",
              "ref": i >= 10,
              "right": {
                "id": 5,
                "kind": "number",
                "ref": 10,
                "value": 10n,
              },
            },
            "op": "||",
            "ref": i >= 10 || i <= 100,
            "right": {
              "id": 9,
              "kind": "op_binary",
              "left": {
                "id": 7,
                "kind": "id",
                "ref": i,
                "value": "i",
              },
              "op": "<=",
              "ref": i <= 100,
              "right": {
                "id": 8,
                "kind": "number",
                "ref": 100,
                "value": 100n,
              },
            },
          },
          "id": 16,
          "kind": "statement_while",
          "ref": while(i >= 10 || i <= 100) {
        i = i + 1;
    },
          "statements": [
            {
              "expression": {
                "id": 14,
                "kind": "op_binary",
                "left": {
                  "id": 12,
                  "kind": "id",
                  "ref": i,
                  "value": "i",
                },
                "op": "+",
                "ref": i + 1,
                "right": {
                  "id": 13,
                  "kind": "number",
                  "ref": 1,
                  "value": 1n,
                },
              },
              "id": 15,
              "kind": "statement_assign",
              "path": [
                {
                  "id": 11,
                  "kind": "lvalue_ref",
                  "name": "i",
                  "ref": i,
                },
              ],
              "ref": i = i + 1;,
            },
          ],
        },
      ],
    },
  ],
  "id": 18,
  "kind": "program",
}
`;

exports[`grammar should parse case-17 1`] = `
{
  "entries": [
    {
      "fields": [
        {
          "as": null,
          "id": 2,
          "init": null,
          "kind": "def_field",
          "name": "x",
          "ref": x: Int;,
          "type": {
            "id": 1,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "as": null,
          "id": 4,
          "init": null,
          "kind": "def_field",
          "name": "y",
          "ref": y: Int;,
          "type": {
            "id": 3,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "id": 5,
      "kind": "def_struct",
      "message": false,
      "name": "A",
      "origin": "user",
      "prefix": null,
      "ref": struct A {
    x: Int;
    y: Int;
},
    },
    {
      "attributes": [],
      "id": 10,
      "kind": "def_constant",
      "name": "a",
      "ref": const a: A = new { x: 1 };,
      "type": {
        "id": 6,
        "kind": "type_ref_simple",
        "name": "A",
        "optional": false,
        "ref": A,
      },
      "value": {
        "args": [
          {
            "exp": {
              "id": 7,
              "kind": "number",
              "ref": 1,
              "value": 1n,
            },
            "id": 8,
            "kind": "new_parameter",
            "name": "x",
            "ref": x: 1,
          },
        ],
        "id": 9,
        "kind": "op_new",
        "ref": new { x: 1 },
        "type": "new",
      },
    },
    {
      "args": [],
      "attributes": [],
      "id": 18,
      "kind": "def_function",
      "name": "getA",
      "origin": "user",
      "ref": fun getA(): A {
    return A {
        x: 1,
        y: 2,
    };
},
      "return": {
        "id": 11,
        "kind": "type_ref_simple",
        "name": "A",
        "optional": false,
        "ref": A,
      },
      "statements": [
        {
          "expression": {
            "args": [
              {
                "exp": {
                  "id": 12,
                  "kind": "number",
                  "ref": 1,
                  "value": 1n,
                },
                "id": 13,
                "kind": "new_parameter",
                "name": "x",
                "ref": x: 1,
              },
              {
                "exp": {
                  "id": 14,
                  "kind": "number",
                  "ref": 2,
                  "value": 2n,
                },
                "id": 15,
                "kind": "new_parameter",
                "name": "y",
                "ref": y: 2,
              },
            ],
            "id": 16,
            "kind": "op_new",
            "ref": A {
        x: 1,
        y: 2,
    },
            "type": "A",
          },
          "id": 17,
          "kind": "statement_return",
          "ref": return A {
        x: 1,
        y: 2,
    };,
        },
      ],
    },
    {
      "fields": [
        {
          "as": null,
          "id": 20,
          "init": null,
          "kind": "def_field",
          "name": "x",
          "ref": x: Int;,
          "type": {
            "id": 19,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "as": null,
          "id": 22,
          "init": null,
          "kind": "def_field",
          "name": "y",
          "ref": y: Int;,
          "type": {
            "id": 21,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "id": 23,
      "kind": "def_struct",
      "message": true,
      "name": "B",
      "origin": "user",
      "prefix": null,
      "ref": message B {
    x: Int;
    y: Int;
},
    },
    {
      "attributes": [],
      "id": 30,
      "kind": "def_constant",
      "name": "b",
      "ref": const b: B = new {
    x: 2,
    y: 3,
};,
      "type": {
        "id": 24,
        "kind": "type_ref_simple",
        "name": "B",
        "optional": false,
        "ref": B,
      },
      "value": {
        "args": [
          {
            "exp": {
              "id": 25,
              "kind": "number",
              "ref": 2,
              "value": 2n,
            },
            "id": 26,
            "kind": "new_parameter",
            "name": "x",
            "ref": x: 2,
          },
          {
            "exp": {
              "id": 27,
              "kind": "number",
              "ref": 3,
              "value": 3n,
            },
            "id": 28,
            "kind": "new_parameter",
            "name": "y",
            "ref": y: 3,
          },
        ],
        "id": 29,
        "kind": "op_new",
        "ref": new {
    x: 2,
    y: 3,
},
        "type": "new",
      },
    },
    {
      "args": [],
      "attributes": [],
      "id": 38,
      "kind": "def_function",
      "name": "getB",
      "origin": "user",
      "ref": fun getB(): B {
    return B { x: 1, y: 5, };
},
      "return": {
        "id": 31,
        "kind": "type_ref_simple",
        "name": "B",
        "optional": false,
        "ref": B,
      },
      "statements": [
        {
          "expression": {
            "args": [
              {
                "exp": {
                  "id": 32,
                  "kind": "number",
                  "ref": 1,
                  "value": 1n,
                },
                "id": 33,
                "kind": "new_parameter",
                "name": "x",
                "ref": x: 1,
              },
              {
                "exp": {
                  "id": 34,
                  "kind": "number",
                  "ref": 5,
                  "value": 5n,
                },
                "id": 35,
                "kind": "new_parameter",
                "name": "y",
                "ref": y: 5,
              },
            ],
            "id": 36,
            "kind": "op_new",
            "ref": B { x: 1, y: 5, },
            "type": "B",
          },
          "id": 37,
          "kind": "statement_return",
          "ref": return B { x: 1, y: 5, };,
        },
      ],
    },
  ],
  "id": 39,
  "kind": "program",
}
`;

exports[`grammar should parse case-18 1`] = `
{
  "entries": [
    {
      "fields": [
        {
          "as": null,
          "id": 2,
          "init": null,
          "kind": "def_field",
          "name": "x",
          "ref": x: Int;,
          "type": {
            "id": 1,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "id": 3,
      "kind": "def_struct",
      "message": false,
      "name": "A",
      "origin": "user",
      "prefix": null,
      "ref": struct A {
    x: Int;
},
    },
    {
      "fields": [
        {
          "as": "coin",
          "id": 5,
          "init": null,
          "kind": "def_field",
          "name": "x",
          "ref": x: Int as coin;,
          "type": {
            "id": 4,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "id": 6,
      "kind": "def_struct",
      "message": true,
      "name": "B",
      "origin": "user",
      "prefix": null,
      "ref": message B {
    x: Int as coin;
},
    },
  ],
  "id": 7,
  "kind": "program",
}
`;

exports[`grammar should parse case-19 1`] = `
{
  "entries": [
    {
      "fields": [
        {
          "as": null,
          "id": 3,
          "init": {
            "id": 2,
            "kind": "number",
            "ref": 1000,
            "value": 1000n,
          },
          "kind": "def_field",
          "name": "x",
          "ref": x: Int = 1000;,
          "type": {
            "id": 1,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "id": 4,
      "kind": "def_struct",
      "message": false,
      "name": "A",
      "origin": "user",
      "prefix": null,
      "ref": struct A {
    x: Int = 1000;
},
    },
    {
      "fields": [
        {
          "as": "coins",
          "id": 7,
          "init": {
            "id": 6,
            "kind": "number",
            "ref": 1000,
            "value": 1000n,
          },
          "kind": "def_field",
          "name": "x",
          "ref": x: Int as coins = 1000;,
          "type": {
            "id": 5,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "as": null,
          "id": 10,
          "init": {
            "id": 9,
            "kind": "boolean",
            "ref": true,
            "value": true,
          },
          "kind": "def_field",
          "name": "y",
          "ref": y: Bool = true;,
          "type": {
            "id": 8,
            "kind": "type_ref_simple",
            "name": "Bool",
            "optional": false,
            "ref": Bool,
          },
        },
      ],
      "id": 11,
      "kind": "def_struct",
      "message": true,
      "name": "B",
      "origin": "user",
      "prefix": null,
      "ref": message B {
    x: Int as coins = 1000;
    y: Bool = true;
},
    },
  ],
  "id": 12,
  "kind": "program",
}
`;

exports[`grammar should parse case-20 1`] = `
{
  "entries": [
    {
      "fields": [
        {
          "as": null,
          "id": 2,
          "init": null,
          "kind": "def_field",
          "name": "y",
          "ref": y: map<Int, Int>;,
          "type": {
            "id": 1,
            "key": "Int",
            "keyAs": null,
            "kind": "type_ref_map",
            "ref": map<Int, Int>,
            "value": "Int",
            "valueAs": null,
          },
        },
      ],
      "id": 3,
      "kind": "def_struct",
      "message": false,
      "name": "A",
      "origin": "user",
      "prefix": null,
      "ref": struct A {
    y: map<Int, Int>;
},
    },
    {
      "fields": [
        {
          "as": null,
          "id": 5,
          "init": null,
          "kind": "def_field",
          "name": "x",
          "ref": x: map<Int, Int>;,
          "type": {
            "id": 4,
            "key": "Int",
            "keyAs": null,
            "kind": "type_ref_map",
            "ref": map<Int, Int>,
            "value": "Int",
            "valueAs": null,
          },
        },
      ],
      "id": 6,
      "kind": "def_struct",
      "message": true,
      "name": "B",
      "origin": "user",
      "prefix": null,
      "ref": message B {
    x: map<Int, Int>;
},
    },
  ],
  "id": 7,
  "kind": "program",
}
`;

exports[`grammar should parse case-21 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 4,
      "kind": "def_function",
      "name": "main",
      "origin": "user",
      "ref": fun main(): Int {
    return 1;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 2,
            "kind": "number",
            "ref": 1,
            "value": 1n,
          },
          "id": 3,
          "kind": "statement_return",
          "ref": return 1;,
        },
      ],
    },
  ],
  "id": 5,
  "kind": "program",
}
`;

exports[`grammar should parse case-22 1`] = `
{
  "entries": [
    {
      "id": 1,
      "kind": "primitive",
      "name": "Int",
      "origin": "user",
      "ref": primitive Int;,
    },
    {
      "attributes": [],
      "declarations": [
        {
          "as": null,
          "id": 3,
          "init": null,
          "kind": "def_field",
          "name": "c",
          "ref": c: Int;,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "id": 4,
      "kind": "def_trait",
      "name": "OtherTrait",
      "origin": "user",
      "ref": trait OtherTrait {
    c: Int;
},
      "traits": [],
    },
    {
      "attributes": [],
      "declarations": [
        {
          "as": null,
          "id": 6,
          "init": null,
          "kind": "def_field",
          "name": "a",
          "ref": a: Int;,
          "type": {
            "id": 5,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "id": 8,
      "kind": "def_trait",
      "name": "SomeTrait",
      "origin": "user",
      "ref": trait SomeTrait with OtherTrait, {
    a: Int;
},
      "traits": [
        {
          "id": 7,
          "kind": "id",
          "ref": OtherTrait,
          "value": "OtherTrait",
        },
      ],
    },
    {
      "attributes": [],
      "declarations": [
        {
          "as": null,
          "id": 10,
          "init": null,
          "kind": "def_field",
          "name": "b",
          "ref": b: Int;,
          "type": {
            "id": 9,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "id": 12,
      "kind": "def_contract",
      "name": "Main",
      "origin": "user",
      "ref": contract Main with SomeTrait, {
    b: Int;
},
      "traits": [
        {
          "id": 11,
          "kind": "id",
          "ref": SomeTrait,
          "value": "SomeTrait",
        },
      ],
    },
  ],
  "id": 13,
  "kind": "program",
}
`;

exports[`grammar should parse case-23 1`] = `
{
  "entries": [
    {
      "id": 1,
      "kind": "primitive",
      "name": "Int",
      "origin": "user",
      "ref": primitive Int;,
    },
    {
      "attributes": [],
      "declarations": [
        {
          "as": null,
          "id": 3,
          "init": null,
          "kind": "def_field",
          "name": "a",
          "ref": a: Int;,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "args": [],
          "attributes": [
            {
              "ref": virtual,
              "type": "virtual",
            },
          ],
          "id": 7,
          "kind": "def_function",
          "name": "a",
          "origin": "user",
          "ref": virtual fun a(): Int {
        return a;
    },
          "return": {
            "id": 4,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
          "statements": [
            {
              "expression": {
                "id": 5,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "id": 6,
              "kind": "statement_return",
              "ref": return a;,
            },
          ],
        },
      ],
      "id": 8,
      "kind": "def_trait",
      "name": "SomeTrait",
      "origin": "user",
      "ref": trait SomeTrait {
    a: Int;

    virtual fun a(): Int {
        return a;
    }
},
      "traits": [],
    },
    {
      "attributes": [],
      "declarations": [
        {
          "as": null,
          "id": 10,
          "init": null,
          "kind": "def_field",
          "name": "b",
          "ref": b: Int;,
          "type": {
            "id": 9,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "args": [],
          "attributes": [
            {
              "ref": override,
              "type": "overrides",
            },
          ],
          "id": 14,
          "kind": "def_function",
          "name": "a",
          "origin": "user",
          "ref": override fun a(): Int {
        return b;
    },
          "return": {
            "id": 11,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
          "statements": [
            {
              "expression": {
                "id": 12,
                "kind": "id",
                "ref": b,
                "value": "b",
              },
              "id": 13,
              "kind": "statement_return",
              "ref": return b;,
            },
          ],
        },
      ],
      "id": 16,
      "kind": "def_contract",
      "name": "Main",
      "origin": "user",
      "ref": contract Main with SomeTrait {
    b: Int;

    override fun a(): Int {
        return b;
    }
},
      "traits": [
        {
          "id": 15,
          "kind": "id",
          "ref": SomeTrait,
          "value": "SomeTrait",
        },
      ],
    },
  ],
  "id": 17,
  "kind": "program",
}
`;

exports[`grammar should parse case-24 1`] = `
{
  "entries": [
    {
      "id": 1,
      "kind": "primitive",
      "name": "Int",
      "origin": "user",
      "ref": primitive Int;,
    },
    {
      "attributes": [],
      "declarations": [
        {
          "as": null,
          "id": 3,
          "init": null,
          "kind": "def_field",
          "name": "a",
          "ref": a: Int;,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "args": [],
          "attributes": [
            {
              "ref": virtual,
              "type": "virtual",
            },
          ],
          "id": 7,
          "kind": "def_function",
          "name": "a",
          "origin": "user",
          "ref": virtual fun a(): Int {
        return a;
    },
          "return": {
            "id": 4,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
          "statements": [
            {
              "expression": {
                "id": 5,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "id": 6,
              "kind": "statement_return",
              "ref": return a;,
            },
          ],
        },
      ],
      "id": 8,
      "kind": "def_trait",
      "name": "SomeTrait",
      "origin": "user",
      "ref": trait SomeTrait {
    a: Int;

    virtual fun a(): Int {
        return a;
    }
},
      "traits": [],
    },
    {
      "attributes": [],
      "declarations": [
        {
          "as": null,
          "id": 10,
          "init": null,
          "kind": "def_field",
          "name": "b",
          "ref": b: Int;,
          "type": {
            "id": 9,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "args": [],
          "attributes": [
            {
              "ref": override,
              "type": "overrides",
            },
          ],
          "id": 14,
          "kind": "def_function",
          "name": "a",
          "origin": "user",
          "ref": override fun a(): Int {
        return "hello world!";
    },
          "return": {
            "id": 11,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
          "statements": [
            {
              "expression": {
                "id": 12,
                "kind": "string",
                "ref": "hello world!",
                "value": "hello world!",
              },
              "id": 13,
              "kind": "statement_return",
              "ref": return "hello world!";,
            },
          ],
        },
      ],
      "id": 16,
      "kind": "def_contract",
      "name": "Main",
      "origin": "user",
      "ref": contract Main with SomeTrait {
    b: Int;

    override fun a(): Int {
        return "hello world!";
    }
},
      "traits": [
        {
          "id": 15,
          "kind": "id",
          "ref": SomeTrait,
          "value": "SomeTrait",
        },
      ],
    },
  ],
  "id": 17,
  "kind": "program",
}
`;

exports[`grammar should parse case-25 1`] = `
{
  "entries": [
    {
      "args": [
        {
          "id": 3,
          "kind": "def_argument",
          "name": "a",
          "ref": a: Int,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "id": 5,
          "kind": "def_argument",
          "name": "b",
          "ref": b: Int,
          "type": {
            "id": 4,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "attributes": [],
      "id": 16,
      "kind": "def_function",
      "name": "function",
      "origin": "user",
      "ref": fun function(a: Int, b: Int): Int {
    return (a >> b) || (a << (32 - b));
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 14,
            "kind": "op_binary",
            "left": {
              "id": 8,
              "kind": "op_binary",
              "left": {
                "id": 6,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "op": ">>",
              "ref": a >> b,
              "right": {
                "id": 7,
                "kind": "id",
                "ref": b,
                "value": "b",
              },
            },
            "op": "||",
            "ref": (a >> b) || (a << (32 - b)),
            "right": {
              "id": 13,
              "kind": "op_binary",
              "left": {
                "id": 9,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "op": "<<",
              "ref": a << (32 - b),
              "right": {
                "id": 12,
                "kind": "op_binary",
                "left": {
                  "id": 10,
                  "kind": "number",
                  "ref": 32,
                  "value": 32n,
                },
                "op": "-",
                "ref": 32 - b,
                "right": {
                  "id": 11,
                  "kind": "id",
                  "ref": b,
                  "value": "b",
                },
              },
            },
          },
          "id": 15,
          "kind": "statement_return",
          "ref": return (a >> b) || (a << (32 - b));,
        },
      ],
    },
    {
      "args": [
        {
          "id": 19,
          "kind": "def_argument",
          "name": "a",
          "ref": a: Int,
          "type": {
            "id": 18,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "id": 21,
          "kind": "def_argument",
          "name": "b",
          "ref": b: Int,
          "type": {
            "id": 20,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "attributes": [],
      "id": 32,
      "kind": "def_function",
      "name": "anotherFunction",
      "origin": "user",
      "ref": fun anotherFunction(
    a: Int,
    b: Int,
    ): Int {
    return (a >> b) || (a << (32 - b));
},
      "return": {
        "id": 17,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 30,
            "kind": "op_binary",
            "left": {
              "id": 24,
              "kind": "op_binary",
              "left": {
                "id": 22,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "op": ">>",
              "ref": a >> b,
              "right": {
                "id": 23,
                "kind": "id",
                "ref": b,
                "value": "b",
              },
            },
            "op": "||",
            "ref": (a >> b) || (a << (32 - b)),
            "right": {
              "id": 29,
              "kind": "op_binary",
              "left": {
                "id": 25,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "op": "<<",
              "ref": a << (32 - b),
              "right": {
                "id": 28,
                "kind": "op_binary",
                "left": {
                  "id": 26,
                  "kind": "number",
                  "ref": 32,
                  "value": 32n,
                },
                "op": "-",
                "ref": 32 - b,
                "right": {
                  "id": 27,
                  "kind": "id",
                  "ref": b,
                  "value": "b",
                },
              },
            },
          },
          "id": 31,
          "kind": "statement_return",
          "ref": return (a >> b) || (a << (32 - b));,
        },
      ],
    },
    {
      "args": [
        {
          "id": 34,
          "kind": "def_argument",
          "name": "self",
          "ref": self: Int,
          "type": {
            "id": 33,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "id": 36,
          "kind": "def_argument",
          "name": "c",
          "ref": c: Int,
          "type": {
            "id": 35,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "id": 38,
          "kind": "def_argument",
          "name": "d",
          "ref": d: Int,
          "type": {
            "id": 37,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "attributes": [
        {
          "ref": extends,
          "type": "extends",
        },
      ],
      "id": 45,
      "kind": "def_function",
      "name": "extension",
      "origin": "user",
      "ref": extends fun extension(self: Int, c: Int, d: Int) {
    return self + c + d;
},
      "return": null,
      "statements": [
        {
          "expression": {
            "id": 43,
            "kind": "op_binary",
            "left": {
              "id": 41,
              "kind": "op_binary",
              "left": {
                "id": 39,
                "kind": "id",
                "ref": self,
                "value": "self",
              },
              "op": "+",
              "ref": self + c,
              "right": {
                "id": 40,
                "kind": "id",
                "ref": c,
                "value": "c",
              },
            },
            "op": "+",
            "ref": self + c + d,
            "right": {
              "id": 42,
              "kind": "id",
              "ref": d,
              "value": "d",
            },
          },
          "id": 44,
          "kind": "statement_return",
          "ref": return self + c + d;,
        },
      ],
    },
    {
      "args": [
        {
          "id": 47,
          "kind": "def_argument",
          "name": "a",
          "ref": a: Int,
          "type": {
            "id": 46,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "id": 49,
          "kind": "def_argument",
          "name": "b",
          "ref": b: Int,
          "type": {
            "id": 48,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "attributes": [],
      "id": 61,
      "kind": "def_function",
      "name": "coverage",
      "origin": "user",
      "ref": fun coverage(a: Int, b: Int) {
    let k: Int = a.extension(
        b,
        4,
    );

    let c: Int = anotherFunction(
        a,
        b,
    );
},
      "return": null,
      "statements": [
        {
          "expression": {
            "args": [
              {
                "id": 52,
                "kind": "id",
                "ref": b,
                "value": "b",
              },
              {
                "id": 53,
                "kind": "number",
                "ref": 4,
                "value": 4n,
              },
            ],
            "id": 54,
            "kind": "op_call",
            "name": "extension",
            "ref": a.extension(
        b,
        4,
    ),
            "src": {
              "id": 51,
              "kind": "id",
              "ref": a,
              "value": "a",
            },
          },
          "id": 55,
          "kind": "statement_let",
          "name": "k",
          "ref": let k: Int = a.extension(
        b,
        4,
    );,
          "type": {
            "id": 50,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "args": [
              {
                "id": 57,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              {
                "id": 58,
                "kind": "id",
                "ref": b,
                "value": "b",
              },
            ],
            "id": 59,
            "kind": "op_static_call",
            "name": "anotherFunction",
            "ref": anotherFunction(
        a,
        b,
    ),
          },
          "id": 60,
          "kind": "statement_let",
          "name": "c",
          "ref": let c: Int = anotherFunction(
        a,
        b,
    );,
          "type": {
            "id": 56,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
    },
    {
      "args": [
        {
          "id": 64,
          "kind": "def_argument",
          "name": "a",
          "ref": a: Int,
          "type": {
            "id": 63,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "id": 66,
          "kind": "def_argument",
          "name": "b",
          "ref": b: Int,
          "type": {
            "id": 65,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "attributes": [],
      "id": 71,
      "kind": "def_function",
      "name": "oneMoreFunction",
      "origin": "user",
      "ref": fun oneMoreFunction(
    a: Int,
    b: Int,
    ): Int {
    return anotherFunction(
        a,
        b,
    );
},
      "return": {
        "id": 62,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "args": [
              {
                "id": 67,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              {
                "id": 68,
                "kind": "id",
                "ref": b,
                "value": "b",
              },
            ],
            "id": 69,
            "kind": "op_static_call",
            "name": "anotherFunction",
            "ref": anotherFunction(
        a,
        b,
    ),
          },
          "id": 70,
          "kind": "statement_return",
          "ref": return anotherFunction(
        a,
        b,
    );,
        },
      ],
    },
    {
      "attributes": [],
      "declarations": [
        {
          "args": [
            {
              "id": 73,
              "kind": "def_argument",
              "name": "arg1",
              "ref": arg1: Int,
              "type": {
                "id": 72,
                "kind": "type_ref_simple",
                "name": "Int",
                "optional": false,
                "ref": Int,
              },
            },
            {
              "id": 75,
              "kind": "def_argument",
              "name": "arg2",
              "ref": arg2: Int,
              "type": {
                "id": 74,
                "kind": "type_ref_simple",
                "name": "Int",
                "optional": false,
                "ref": Int,
              },
            },
          ],
          "id": 76,
          "kind": "def_init_function",
          "ref": init(
        arg1: Int,
        arg2: Int,
    ) {},
          "statements": [],
        },
      ],
      "id": 77,
      "kind": "def_contract",
      "name": "TestContract",
      "origin": "user",
      "ref": contract TestContract {
    init(
        arg1: Int,
        arg2: Int,
    ) {}
},
      "traits": [],
    },
    {
      "args": [],
      "attributes": [],
      "id": 83,
      "kind": "def_function",
      "name": "test",
      "origin": "user",
      "ref": fun test() {
    let k: StateInit = initOf TestContract(
        2,
        3,
    );
},
      "return": null,
      "statements": [
        {
          "expression": {
            "args": [
              {
                "id": 79,
                "kind": "number",
                "ref": 2,
                "value": 2n,
              },
              {
                "id": 80,
                "kind": "number",
                "ref": 3,
                "value": 3n,
              },
            ],
            "id": 81,
            "kind": "init_of",
            "name": "TestContract",
            "ref": initOf TestContract(
        2,
        3,
    ),
          },
          "id": 82,
          "kind": "statement_let",
          "name": "k",
          "ref": let k: StateInit = initOf TestContract(
        2,
        3,
    );,
          "type": {
            "id": 78,
            "kind": "type_ref_simple",
            "name": "StateInit",
            "optional": false,
            "ref": StateInit,
          },
        },
      ],
    },
  ],
  "id": 84,
  "kind": "program",
}
`;

exports[`grammar should parse case-26 1`] = `
{
  "entries": [
    {
      "attributes": [],
      "declarations": [
        {
          "attributes": [
            {
              "ref": override,
              "type": "overrides",
            },
          ],
          "id": 3,
          "kind": "def_constant",
          "name": "Test",
          "ref": override const Test: Int = 0;,
          "type": {
            "id": 1,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
          "value": {
            "id": 2,
            "kind": "number",
            "ref": 0,
            "value": 0n,
          },
        },
      ],
      "id": 4,
      "kind": "def_contract",
      "name": "Contract",
      "origin": "user",
      "ref": contract Contract {
    override const Test: Int = 0;
},
      "traits": [],
    },
  ],
  "id": 5,
  "kind": "program",
}
`;

exports[`grammar should parse case-27 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 68,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(): Int {
    let a: Int = 1;
    let b: Int = 2;
    a += b;
    b += a;
    a += 3;
    a += b + 4;
    b -= 1;
    a -= b;
    a -= b - 1;
    b *= 2;
    a *= b;
    a *= b * 2;
    b /= 2;
    a /= b;
    a /= b / 2;
    a %= 2;
    a %= b;
    a %= b % 2;
    return a;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 3,
            "kind": "number",
            "ref": 1,
            "value": 1n,
          },
          "id": 4,
          "kind": "statement_let",
          "name": "a",
          "ref": let a: Int = 1;,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 6,
            "kind": "number",
            "ref": 2,
            "value": 2n,
          },
          "id": 7,
          "kind": "statement_let",
          "name": "b",
          "ref": let b: Int = 2;,
          "type": {
            "id": 5,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 9,
            "kind": "id",
            "ref": b,
            "value": "b",
          },
          "id": 10,
          "kind": "statement_augmentedassign",
          "op": "+",
          "path": [
            {
              "id": 8,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a += b;,
        },
        {
          "expression": {
            "id": 12,
            "kind": "id",
            "ref": a,
            "value": "a",
          },
          "id": 13,
          "kind": "statement_augmentedassign",
          "op": "+",
          "path": [
            {
              "id": 11,
              "kind": "lvalue_ref",
              "name": "b",
              "ref": b,
            },
          ],
          "ref": b += a;,
        },
        {
          "expression": {
            "id": 15,
            "kind": "number",
            "ref": 3,
            "value": 3n,
          },
          "id": 16,
          "kind": "statement_augmentedassign",
          "op": "+",
          "path": [
            {
              "id": 14,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a += 3;,
        },
        {
          "expression": {
            "id": 20,
            "kind": "op_binary",
            "left": {
              "id": 18,
              "kind": "id",
              "ref": b,
              "value": "b",
            },
            "op": "+",
            "ref": b + 4,
            "right": {
              "id": 19,
              "kind": "number",
              "ref": 4,
              "value": 4n,
            },
          },
          "id": 21,
          "kind": "statement_augmentedassign",
          "op": "+",
          "path": [
            {
              "id": 17,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a += b + 4;,
        },
        {
          "expression": {
            "id": 23,
            "kind": "number",
            "ref": 1,
            "value": 1n,
          },
          "id": 24,
          "kind": "statement_augmentedassign",
          "op": "-",
          "path": [
            {
              "id": 22,
              "kind": "lvalue_ref",
              "name": "b",
              "ref": b,
            },
          ],
          "ref": b -= 1;,
        },
        {
          "expression": {
            "id": 26,
            "kind": "id",
            "ref": b,
            "value": "b",
          },
          "id": 27,
          "kind": "statement_augmentedassign",
          "op": "-",
          "path": [
            {
              "id": 25,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a -= b;,
        },
        {
          "expression": {
            "id": 31,
            "kind": "op_binary",
            "left": {
              "id": 29,
              "kind": "id",
              "ref": b,
              "value": "b",
            },
            "op": "-",
            "ref": b - 1,
            "right": {
              "id": 30,
              "kind": "number",
              "ref": 1,
              "value": 1n,
            },
          },
          "id": 32,
          "kind": "statement_augmentedassign",
          "op": "-",
          "path": [
            {
              "id": 28,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a -= b - 1;,
        },
        {
          "expression": {
            "id": 34,
            "kind": "number",
            "ref": 2,
            "value": 2n,
          },
          "id": 35,
          "kind": "statement_augmentedassign",
          "op": "*",
          "path": [
            {
              "id": 33,
              "kind": "lvalue_ref",
              "name": "b",
              "ref": b,
            },
          ],
          "ref": b *= 2;,
        },
        {
          "expression": {
            "id": 37,
            "kind": "id",
            "ref": b,
            "value": "b",
          },
          "id": 38,
          "kind": "statement_augmentedassign",
          "op": "*",
          "path": [
            {
              "id": 36,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a *= b;,
        },
        {
          "expression": {
            "id": 42,
            "kind": "op_binary",
            "left": {
              "id": 40,
              "kind": "id",
              "ref": b,
              "value": "b",
            },
            "op": "*",
            "ref": b * 2,
            "right": {
              "id": 41,
              "kind": "number",
              "ref": 2,
              "value": 2n,
            },
          },
          "id": 43,
          "kind": "statement_augmentedassign",
          "op": "*",
          "path": [
            {
              "id": 39,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a *= b * 2;,
        },
        {
          "expression": {
            "id": 45,
            "kind": "number",
            "ref": 2,
            "value": 2n,
          },
          "id": 46,
          "kind": "statement_augmentedassign",
          "op": "/",
          "path": [
            {
              "id": 44,
              "kind": "lvalue_ref",
              "name": "b",
              "ref": b,
            },
          ],
          "ref": b /= 2;,
        },
        {
          "expression": {
            "id": 48,
            "kind": "id",
            "ref": b,
            "value": "b",
          },
          "id": 49,
          "kind": "statement_augmentedassign",
          "op": "/",
          "path": [
            {
              "id": 47,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a /= b;,
        },
        {
          "expression": {
            "id": 53,
            "kind": "op_binary",
            "left": {
              "id": 51,
              "kind": "id",
              "ref": b,
              "value": "b",
            },
            "op": "/",
            "ref": b / 2,
            "right": {
              "id": 52,
              "kind": "number",
              "ref": 2,
              "value": 2n,
            },
          },
          "id": 54,
          "kind": "statement_augmentedassign",
          "op": "/",
          "path": [
            {
              "id": 50,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a /= b / 2;,
        },
        {
          "expression": {
            "id": 56,
            "kind": "number",
            "ref": 2,
            "value": 2n,
          },
          "id": 57,
          "kind": "statement_augmentedassign",
          "op": "%",
          "path": [
            {
              "id": 55,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a %= 2;,
        },
        {
          "expression": {
            "id": 59,
            "kind": "id",
            "ref": b,
            "value": "b",
          },
          "id": 60,
          "kind": "statement_augmentedassign",
          "op": "%",
          "path": [
            {
              "id": 58,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a %= b;,
        },
        {
          "expression": {
            "id": 64,
            "kind": "op_binary",
            "left": {
              "id": 62,
              "kind": "id",
              "ref": b,
              "value": "b",
            },
            "op": "%",
            "ref": b % 2,
            "right": {
              "id": 63,
              "kind": "number",
              "ref": 2,
              "value": 2n,
            },
          },
          "id": 65,
          "kind": "statement_augmentedassign",
          "op": "%",
          "path": [
            {
              "id": 61,
              "kind": "lvalue_ref",
              "name": "a",
              "ref": a,
            },
          ],
          "ref": a %= b % 2;,
        },
        {
          "expression": {
            "id": 66,
            "kind": "id",
            "ref": a,
            "value": "a",
          },
          "id": 67,
          "kind": "statement_return",
          "ref": return a;,
        },
      ],
    },
  ],
  "id": 69,
  "kind": "program",
}
`;

exports[`grammar should parse case-28 1`] = `
{
  "entries": [
    {
      "args": [],
      "attributes": [],
      "id": 66,
      "kind": "def_function",
      "name": "test_fun",
      "origin": "user",
      "ref": fun test_fun(): Int {
    let a: Int = 123;
    let b: Int = -123;
    let c: Int = 1_0123_00_000;
    let d: Int = 0x123;
    let e: Int = -0x123;
    let f: Int = 0x1_0123_00_000;
    let g: Int = 0b101010;
    let h: Int = -0b101010;
    let i: Int = 0b1_0101_00_000;
    let j: Int = 0o123;
    let k: Int = -0o123;
    let l: Int = 0o1_0123_00_000;
    return a + b + c + d + e + f + g + h + i + j + k + l;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "id": 3,
            "kind": "number",
            "ref": 123,
            "value": 123n,
          },
          "id": 4,
          "kind": "statement_let",
          "name": "a",
          "ref": let a: Int = 123;,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 7,
            "kind": "op_unary",
            "op": "-",
            "ref": -123,
            "right": {
              "id": 6,
              "kind": "number",
              "ref": 123,
              "value": 123n,
            },
          },
          "id": 8,
          "kind": "statement_let",
          "name": "b",
          "ref": let b: Int = -123;,
          "type": {
            "id": 5,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 10,
            "kind": "number",
            "ref": 1_0123_00_000,
            "value": 1012300000n,
          },
          "id": 11,
          "kind": "statement_let",
          "name": "c",
          "ref": let c: Int = 1_0123_00_000;,
          "type": {
            "id": 9,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 13,
            "kind": "number",
            "ref": 0x123,
            "value": 291n,
          },
          "id": 14,
          "kind": "statement_let",
          "name": "d",
          "ref": let d: Int = 0x123;,
          "type": {
            "id": 12,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 17,
            "kind": "op_unary",
            "op": "-",
            "ref": -0x123,
            "right": {
              "id": 16,
              "kind": "number",
              "ref": 0x123,
              "value": 291n,
            },
          },
          "id": 18,
          "kind": "statement_let",
          "name": "e",
          "ref": let e: Int = -0x123;,
          "type": {
            "id": 15,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 20,
            "kind": "number",
            "ref": 0x1_0123_00_000,
            "value": 69024612352n,
          },
          "id": 21,
          "kind": "statement_let",
          "name": "f",
          "ref": let f: Int = 0x1_0123_00_000;,
          "type": {
            "id": 19,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 23,
            "kind": "number",
            "ref": 0b101010,
            "value": 42n,
          },
          "id": 24,
          "kind": "statement_let",
          "name": "g",
          "ref": let g: Int = 0b101010;,
          "type": {
            "id": 22,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 27,
            "kind": "op_unary",
            "op": "-",
            "ref": -0b101010,
            "right": {
              "id": 26,
              "kind": "number",
              "ref": 0b101010,
              "value": 42n,
            },
          },
          "id": 28,
          "kind": "statement_let",
          "name": "h",
          "ref": let h: Int = -0b101010;,
          "type": {
            "id": 25,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 30,
            "kind": "number",
            "ref": 0b1_0101_00_000,
            "value": 672n,
          },
          "id": 31,
          "kind": "statement_let",
          "name": "i",
          "ref": let i: Int = 0b1_0101_00_000;,
          "type": {
            "id": 29,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 33,
            "kind": "number",
            "ref": 0o123,
            "value": 83n,
          },
          "id": 34,
          "kind": "statement_let",
          "name": "j",
          "ref": let j: Int = 0o123;,
          "type": {
            "id": 32,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 37,
            "kind": "op_unary",
            "op": "-",
            "ref": -0o123,
            "right": {
              "id": 36,
              "kind": "number",
              "ref": 0o123,
              "value": 83n,
            },
          },
          "id": 38,
          "kind": "statement_let",
          "name": "k",
          "ref": let k: Int = -0o123;,
          "type": {
            "id": 35,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 40,
            "kind": "number",
            "ref": 0o1_0123_00_000,
            "value": 136937472n,
          },
          "id": 41,
          "kind": "statement_let",
          "name": "l",
          "ref": let l: Int = 0o1_0123_00_000;,
          "type": {
            "id": 39,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 64,
            "kind": "op_binary",
            "left": {
              "id": 62,
              "kind": "op_binary",
              "left": {
                "id": 60,
                "kind": "op_binary",
                "left": {
                  "id": 58,
                  "kind": "op_binary",
                  "left": {
                    "id": 56,
                    "kind": "op_binary",
                    "left": {
                      "id": 54,
                      "kind": "op_binary",
                      "left": {
                        "id": 52,
                        "kind": "op_binary",
                        "left": {
                          "id": 50,
                          "kind": "op_binary",
                          "left": {
                            "id": 48,
                            "kind": "op_binary",
                            "left": {
                              "id": 46,
                              "kind": "op_binary",
                              "left": {
                                "id": 44,
                                "kind": "op_binary",
                                "left": {
                                  "id": 42,
                                  "kind": "id",
                                  "ref": a,
                                  "value": "a",
                                },
                                "op": "+",
                                "ref": a + b,
                                "right": {
                                  "id": 43,
                                  "kind": "id",
                                  "ref": b,
                                  "value": "b",
                                },
                              },
                              "op": "+",
                              "ref": a + b + c,
                              "right": {
                                "id": 45,
                                "kind": "id",
                                "ref": c,
                                "value": "c",
                              },
                            },
                            "op": "+",
                            "ref": a + b + c + d,
                            "right": {
                              "id": 47,
                              "kind": "id",
                              "ref": d,
                              "value": "d",
                            },
                          },
                          "op": "+",
                          "ref": a + b + c + d + e,
                          "right": {
                            "id": 49,
                            "kind": "id",
                            "ref": e,
                            "value": "e",
                          },
                        },
                        "op": "+",
                        "ref": a + b + c + d + e + f,
                        "right": {
                          "id": 51,
                          "kind": "id",
                          "ref": f,
                          "value": "f",
                        },
                      },
                      "op": "+",
                      "ref": a + b + c + d + e + f + g,
                      "right": {
                        "id": 53,
                        "kind": "id",
                        "ref": g,
                        "value": "g",
                      },
                    },
                    "op": "+",
                    "ref": a + b + c + d + e + f + g + h,
                    "right": {
                      "id": 55,
                      "kind": "id",
                      "ref": h,
                      "value": "h",
                    },
                  },
                  "op": "+",
                  "ref": a + b + c + d + e + f + g + h + i,
                  "right": {
                    "id": 57,
                    "kind": "id",
                    "ref": i,
                    "value": "i",
                  },
                },
                "op": "+",
                "ref": a + b + c + d + e + f + g + h + i + j,
                "right": {
                  "id": 59,
                  "kind": "id",
                  "ref": j,
                  "value": "j",
                },
              },
              "op": "+",
              "ref": a + b + c + d + e + f + g + h + i + j + k,
              "right": {
                "id": 61,
                "kind": "id",
                "ref": k,
                "value": "k",
              },
            },
            "op": "+",
            "ref": a + b + c + d + e + f + g + h + i + j + k + l,
            "right": {
              "id": 63,
              "kind": "id",
              "ref": l,
              "value": "l",
            },
          },
          "id": 65,
          "kind": "statement_return",
          "ref": return a + b + c + d + e + f + g + h + i + j + k + l;,
        },
      ],
    },
  ],
  "id": 67,
  "kind": "program",
}
`;

exports[`grammar should parse case-29 1`] = `
{
  "entries": [
    {
      "args": [
        {
          "id": 3,
          "kind": "def_argument",
          "name": "a",
          "ref": a: Int,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "attributes": [],
      "id": 14,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(a: Int): Int {
    let b: Int = a == 123 ? 1 : 2;
    return b;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "condition": {
              "id": 7,
              "kind": "op_binary",
              "left": {
                "id": 5,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "op": "==",
              "ref": a == 123,
              "right": {
                "id": 6,
                "kind": "number",
                "ref": 123,
                "value": 123n,
              },
            },
            "elseBranch": {
              "id": 9,
              "kind": "number",
              "ref": 2,
              "value": 2n,
            },
            "id": 10,
            "kind": "conditional",
            "ref": a == 123 ? 1 : 2,
            "thenBranch": {
              "id": 8,
              "kind": "number",
              "ref": 1,
              "value": 1n,
            },
          },
          "id": 11,
          "kind": "statement_let",
          "name": "b",
          "ref": let b: Int = a == 123 ? 1 : 2;,
          "type": {
            "id": 4,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "expression": {
            "id": 12,
            "kind": "id",
            "ref": b,
            "value": "b",
          },
          "id": 13,
          "kind": "statement_return",
          "ref": return b;,
        },
      ],
    },
  ],
  "id": 15,
  "kind": "program",
}
`;

exports[`grammar should parse case-30 1`] = `
{
  "entries": [
    {
      "args": [
        {
          "id": 3,
          "kind": "def_argument",
          "name": "a",
          "ref": a: Int,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "attributes": [],
      "id": 11,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(a: Int): Int {
    return a == 123 ? 1 : 2;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "condition": {
              "id": 6,
              "kind": "op_binary",
              "left": {
                "id": 4,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "op": "==",
              "ref": a == 123,
              "right": {
                "id": 5,
                "kind": "number",
                "ref": 123,
                "value": 123n,
              },
            },
            "elseBranch": {
              "id": 8,
              "kind": "number",
              "ref": 2,
              "value": 2n,
            },
            "id": 9,
            "kind": "conditional",
            "ref": a == 123 ? 1 : 2,
            "thenBranch": {
              "id": 7,
              "kind": "number",
              "ref": 1,
              "value": 1n,
            },
          },
          "id": 10,
          "kind": "statement_return",
          "ref": return a == 123 ? 1 : 2;,
        },
      ],
    },
  ],
  "id": 12,
  "kind": "program",
}
`;

exports[`grammar should parse case-31 1`] = `
{
  "entries": [
    {
      "args": [
        {
          "id": 3,
          "kind": "def_argument",
          "name": "a",
          "ref": a: Int,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "attributes": [],
      "id": 19,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(a: Int): Int {
    return a == 123 || a == 456 ? a + 1 : a + 2;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "condition": {
              "id": 10,
              "kind": "op_binary",
              "left": {
                "id": 6,
                "kind": "op_binary",
                "left": {
                  "id": 4,
                  "kind": "id",
                  "ref": a,
                  "value": "a",
                },
                "op": "==",
                "ref": a == 123,
                "right": {
                  "id": 5,
                  "kind": "number",
                  "ref": 123,
                  "value": 123n,
                },
              },
              "op": "||",
              "ref": a == 123 || a == 456,
              "right": {
                "id": 9,
                "kind": "op_binary",
                "left": {
                  "id": 7,
                  "kind": "id",
                  "ref": a,
                  "value": "a",
                },
                "op": "==",
                "ref": a == 456,
                "right": {
                  "id": 8,
                  "kind": "number",
                  "ref": 456,
                  "value": 456n,
                },
              },
            },
            "elseBranch": {
              "id": 16,
              "kind": "op_binary",
              "left": {
                "id": 14,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "op": "+",
              "ref": a + 2,
              "right": {
                "id": 15,
                "kind": "number",
                "ref": 2,
                "value": 2n,
              },
            },
            "id": 17,
            "kind": "conditional",
            "ref": a == 123 || a == 456 ? a + 1 : a + 2,
            "thenBranch": {
              "id": 13,
              "kind": "op_binary",
              "left": {
                "id": 11,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "op": "+",
              "ref": a + 1,
              "right": {
                "id": 12,
                "kind": "number",
                "ref": 1,
                "value": 1n,
              },
            },
          },
          "id": 18,
          "kind": "statement_return",
          "ref": return a == 123 || a == 456 ? a + 1 : a + 2;,
        },
      ],
    },
  ],
  "id": 20,
  "kind": "program",
}
`;

exports[`grammar should parse case-32 1`] = `
{
  "entries": [
    {
      "args": [
        {
          "id": 3,
          "kind": "def_argument",
          "name": "a",
          "ref": a: Int,
          "type": {
            "id": 2,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "attributes": [],
      "id": 24,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(a: Int): Int {
    return a == 123 || a == 456 ? (a == 10 ? a : a * 2) : a + 2;
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "condition": {
              "id": 10,
              "kind": "op_binary",
              "left": {
                "id": 6,
                "kind": "op_binary",
                "left": {
                  "id": 4,
                  "kind": "id",
                  "ref": a,
                  "value": "a",
                },
                "op": "==",
                "ref": a == 123,
                "right": {
                  "id": 5,
                  "kind": "number",
                  "ref": 123,
                  "value": 123n,
                },
              },
              "op": "||",
              "ref": a == 123 || a == 456,
              "right": {
                "id": 9,
                "kind": "op_binary",
                "left": {
                  "id": 7,
                  "kind": "id",
                  "ref": a,
                  "value": "a",
                },
                "op": "==",
                "ref": a == 456,
                "right": {
                  "id": 8,
                  "kind": "number",
                  "ref": 456,
                  "value": 456n,
                },
              },
            },
            "elseBranch": {
              "id": 21,
              "kind": "op_binary",
              "left": {
                "id": 19,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
              "op": "+",
              "ref": a + 2,
              "right": {
                "id": 20,
                "kind": "number",
                "ref": 2,
                "value": 2n,
              },
            },
            "id": 22,
            "kind": "conditional",
            "ref": a == 123 || a == 456 ? (a == 10 ? a : a * 2) : a + 2,
            "thenBranch": {
              "condition": {
                "id": 13,
                "kind": "op_binary",
                "left": {
                  "id": 11,
                  "kind": "id",
                  "ref": a,
                  "value": "a",
                },
                "op": "==",
                "ref": a == 10,
                "right": {
                  "id": 12,
                  "kind": "number",
                  "ref": 10,
                  "value": 10n,
                },
              },
              "elseBranch": {
                "id": 17,
                "kind": "op_binary",
                "left": {
                  "id": 15,
                  "kind": "id",
                  "ref": a,
                  "value": "a",
                },
                "op": "*",
                "ref": a * 2,
                "right": {
                  "id": 16,
                  "kind": "number",
                  "ref": 2,
                  "value": 2n,
                },
              },
              "id": 18,
              "kind": "conditional",
              "ref": a == 10 ? a : a * 2,
              "thenBranch": {
                "id": 14,
                "kind": "id",
                "ref": a,
                "value": "a",
              },
            },
          },
          "id": 23,
          "kind": "statement_return",
          "ref": return a == 123 || a == 456 ? (a == 10 ? a : a * 2) : a + 2;,
        },
      ],
    },
  ],
  "id": 25,
  "kind": "program",
}
`;

exports[`grammar should parse case-33 1`] = `
{
  "entries": [
    {
      "args": [
        {
          "id": 3,
          "kind": "def_argument",
          "name": "m",
          "ref": m: map<Int, Int>,
          "type": {
            "id": 2,
            "key": "Int",
            "keyAs": null,
            "kind": "type_ref_map",
            "ref": map<Int, Int>,
            "value": "Int",
            "valueAs": null,
          },
        },
      ],
      "attributes": [],
      "id": 9,
      "kind": "def_function",
      "name": "testFunc",
      "origin": "user",
      "ref": fun testFunc(m: map<Int, Int>): Int {
    return m.asCell()!!.hash();
},
      "return": {
        "id": 1,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "statements": [
        {
          "expression": {
            "args": [],
            "id": 7,
            "kind": "op_call",
            "name": "hash",
            "ref": m.asCell()!!.hash(),
            "src": {
              "id": 6,
              "kind": "op_unary",
              "op": "!!",
              "ref": m.asCell()!!,
              "right": {
                "args": [],
                "id": 5,
                "kind": "op_call",
                "name": "asCell",
                "ref": m.asCell(),
                "src": {
                  "id": 4,
                  "kind": "id",
                  "ref": m,
                  "value": "m",
                },
              },
            },
          },
          "id": 8,
          "kind": "statement_return",
          "ref": return m.asCell()!!.hash();,
        },
      ],
    },
  ],
  "id": 10,
  "kind": "program",
}
`;

exports[`grammar should parse case-34 1`] = `
{
  "entries": [
    {
      "fields": [
        {
          "as": null,
          "id": 2,
          "init": null,
          "kind": "def_field",
          "name": "x",
          "ref": x: Int;,
          "type": {
            "id": 1,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
        {
          "as": null,
          "id": 4,
          "init": null,
          "kind": "def_field",
          "name": "y",
          "ref": y: Int;,
          "type": {
            "id": 3,
            "kind": "type_ref_simple",
            "name": "Int",
            "optional": false,
            "ref": Int,
          },
        },
      ],
      "id": 5,
      "kind": "def_struct",
      "message": false,
      "name": "A",
      "origin": "user",
      "prefix": null,
      "ref": struct A {
    x: Int;
    y: Int;
},
    },
    {
      "attributes": [],
      "id": 8,
      "kind": "def_constant",
      "name": "x",
      "ref": const x: Int = 5;,
      "type": {
        "id": 6,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "value": {
        "id": 7,
        "kind": "number",
        "ref": 5,
        "value": 5n,
      },
    },
    {
      "attributes": [],
      "id": 11,
      "kind": "def_constant",
      "name": "y",
      "ref": const y: Int = 6;,
      "type": {
        "id": 9,
        "kind": "type_ref_simple",
        "name": "Int",
        "optional": false,
        "ref": Int,
      },
      "value": {
        "id": 10,
        "kind": "number",
        "ref": 6,
        "value": 6n,
      },
    },
    {
      "attributes": [],
      "id": 18,
      "kind": "def_constant",
      "name": "D",
      "ref": const D: A = A { x, y };,
      "type": {
        "id": 12,
        "kind": "type_ref_simple",
        "name": "A",
        "optional": false,
        "ref": A,
      },
      "value": {
        "args": [
          {
            "exp": {
              "id": 13,
              "kind": "id",
              "ref": x,
              "value": "x",
            },
            "id": 14,
            "kind": "new_parameter",
            "name": "x",
            "ref": x,
          },
          {
            "exp": {
              "id": 15,
              "kind": "id",
              "ref": y,
              "value": "y",
            },
            "id": 16,
            "kind": "new_parameter",
            "name": "y",
            "ref": y,
          },
        ],
        "id": 17,
        "kind": "op_new",
        "ref": A { x, y },
        "type": "A",
      },
    },
  ],
  "id": 19,
  "kind": "program",
}
`;
